!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("redux")):"function"==typeof define&&define.amd?define(["redux"],t):"object"==typeof exports?exports["redux-rails"]=t(require("redux")):e["redux-rails"]=t(e.redux)}(window,function(e){return function(e){var t={};function r(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(o,a,function(t){return e[t]}.bind(null,a));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=0,a=(t.determinOptimisticUpdateSetting=function(e){var t=e.resourceConfig,r=e.config,o=e.defaultConfig,a=void 0===o?{}:o;return i(t.optimisticUpdateEnabled)?t.optimisticUpdateEnabled:i(r.resources.optimisticUpdateEnabled)?r.resources.optimisticUpdateEnabled:i(r.optimisticUpdateEnabled)?r.optimisticUpdateEnabled:!i(a.optimisticUpdateEnabled)||a.optimisticUpdateEnabled},t.determineResourceType=function(e){var t=e.controller;return"s"===t[t.length-1]?"collection":"member"}),i=(t.getResourceNameSpace=function(e){var t=e.config,r=e.resource,o=t.resources[r].controller;return"collection"===a({controller:o})?"models":"attributes"},t.getResourceIdAttribute=function(e){var t=e.config,r=e.resource;return t.resources[r].idAttribute||"id"},t.getUniqueClientId=function(){return++o},t.isBool=function(e){return"boolean"==typeof e});t.getConfig=function(e){var t=e.config,r=e.store;return"function"==typeof t?t(r):t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.railsActions=t.middleWare=t.combineConfigs=t.apiReducer=void 0;var o=c(r(2)),a=c(r(3)),i=c(r(6)),n=c(r(7));function c(e){return e&&e.__esModule?e:{default:e}}t.apiReducer=a.default,t.combineConfigs=n.default,t.middleWare=o.default,t.railsActions=i.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],o=!0,a=!1,i=void 0;try{for(var n,c=e[Symbol.iterator]();!(o=(n=c.next()).done)&&(r.push(n.value),!t||r.length!==t);o=!0);}catch(e){a=!0,i=e}finally{try{!o&&c.return&&c.return()}finally{if(a)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=r(0),c={},d={SHOW:"GET",INDEX:"GET",CREATE:"POST",UPDATE:"PUT",DESTROY:"DELETE"},s=function(e,t){return e+"="+encodeURIComponent(t)},u=function(e,t){return Array.isArray(t)?function(e,t){return t.map(function(t){return s(e+"[]",t)})}(e,t):s(e,t)},l=function(e){var t=e.baseUrl,r=e.controller,o=e.railsAction,a=e.data,i=e.queryParams,c=void 0===i?{}:i,s=(0,n.determineResourceType)({controller:r}),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],r=Object.keys(e).filter(function(t){return void 0!==e[t]||null!==e[t]});return 0===r.length||"GET"!==d[t]?"":"?"+r.map(function(t){return u(t,e[t])}).join("&")}(c,o);return""+t+r+("collection"===s&&"INDEX"!==o&&"CREATE"!==o?"/"+a.id:"")+l},f=function(e){var t=e.resource,r=p({resource:t});r.shift(),r.length>0&&b(r[0])},m=function(e){var t=e.store,r=e.resource,o=e.railsAction,a=e.error,i=e.id,n=e.cId,c=e.optimisticUpdateEnabled,d=e.reject,s={type:r+"."+o+"_ERROR",error:a,id:i,cId:n},u="CREATE"===o;t.dispatch(s),["CREATE","UPDATE"].includes(o)&&c&&t.dispatch({type:r+".UNSET_OPTIMISTIC_DATA",id:i,cId:n,destroy:u}),d(s)},b=function(e){var t=e.store,r=e.resource,o=e.config,a=e.data,c=void 0===a?{}:a,s=e.railsAction,u=e.controllerOverride,b=e.fetchParamsOverride,p=e.queryParamsOverride,y=e.resolve,g=e.reject,E=o.resources[r],I=E.baseUrl||o.baseUrl,A=u||E.controller,M=(0,n.getResourceIdAttribute)({config:o,resource:r}),h=b||E.fetchParams||o.fetchParams,S=p||E.queryParams||o.queryParams,D=function(e){var t=e.railsAction,r=(e.resource,e.config,e.data),o=e.fetchParams,a=void 0===o?{}:o,n=d[t],c=new Headers(a.headers||{}),s=Object.assign({},a,{method:n,headers:c});return"object"===(void 0===r?"undefined":i(r))&&"GET"!==n&&(s.body=JSON.stringify(r)),s}({railsAction:s,resource:r,data:c,config:o,fetchParams:h}),O=l({baseUrl:I,controller:A,railsAction:s,data:c,fetchParams:h,queryParams:S}),_=(0,n.determinOptimisticUpdateSetting)({resourceConfig:E,config:o}),T=void 0;"CREATE"===s&&(T=(0,n.getUniqueClientId)(),t.dispatch({type:r+".ASSIGN_CID",cId:T}),t.dispatch({type:r+".SET_LOADING",cId:T})),["CREATE","UPDATE"].includes(s)&&_&&t.dispatch({type:r+".SET_OPTIMISTIC_DATA",id:c.id,cId:T,data:c}),fetch(O,D).then(function(e){e.json().then(function(a){var i=a&&a[M]||c.id;if(!e.ok)return m({store:t,resource:r,railsAction:s,id:i,cId:T,optimisticUpdateEnabled:_,reject:g,error:a.error||{message:e.statusText}});!function(e){var t=e.store,r=e.resource,o=e.railsAction,a=e.id,i=e.cId,c=e.json,d=e.config,s=e.controller,u=e.resolve,l=r+"."+o+"_SUCCESS",f=v({json:c,resource:r,config:d,resourceType:(0,n.determineResourceType)({controller:s})}),m=f.response,b={cId:i,id:a,metaData:f.metaData,response:m,type:l};t.dispatch(b),u(b)}({store:t,resource:r,railsAction:s,id:i,cId:T,json:a,config:o,controller:A,optimisticUpdateEnabled:_,resolve:y})}).catch(function(e){var o=e&&e.toString&&e.toString();m({store:t,resource:r,railsAction:s,error:o,id:c.id,cId:T,optimisticUpdateEnabled:_,reject:g})})}).catch(function(e){m({store:t,resource:r,railsAction:s,error:e,id:c.id,cId:T,optimisticUpdateEnabled:_,reject:g})}).then(function(){return f({resource:r})})},p=function(e){var t=e.resource;return c[t]||(c[t]={queue:[]}),c[t].queue},v=function(e){var t=e.json,r=e.resource,o=e.config,a=e.resourceType,n=o.resources[r].parse,c=o.resources[r].setMetadata,d=void 0,s={};switch(void 0===n?"undefined":i(n)){case"object":var u=n&&n[a];if(!u){d=t;break}d=u(t);break;case"function":d=n(t);break;default:d=t}switch(void 0===c?"undefined":i(c)){case"object":var l=c&&c[a];if(!l)break;s=l(t);break;case"function":s=c(t);break;default:s={}}return{response:d,metaData:s}},y=function(e){var t=e.action,r=e.config,o=e.fetchData,i=e.next,n=e.resource,c=e.resourceConfig,d=new Promise(function(e,t){var i=a({resolve:e,reject:t},o);(r.disableFetchQueueing||c.disableFetchQueueing)&&b(i),function(e,t){var r=p({resource:e});r.push(t),r.length<=1&&b(t)}(n,i)});return i(t),d};t.default=function(e){return function(t){return function(r){return function(a){var i=(0,n.getConfig)({config:e,store:t.getState()}),c=a.type.split("."),s=o(c,2),u=s[0],l=s[1],f=a.data,m=a.controller,b=a.fetchParams,p=(f||{}).queryParams,v={store:t,resource:u,config:i,data:f,railsAction:l,controllerOverride:m,fetchParamsOverride:b,queryParamsOverride:p},g=i.resources[u];return g&&d[l]?y({action:a,config:i,fetchData:v,next:r,resource:u,resourceConfig:g}):r(a)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},i=r(4),n=r(5),c=r(0);function d(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}t.default=function(e){var t=(0,c.getConfig)({config:e}),r={};return Object.keys(t.resources).forEach(function(e){r[e]=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,n.getInitialState)({config:t,resource:e}),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=t.resources[e]||{},u="attributes"===(0,c.getResourceNameSpace)({config:t,resource:e}),l=(0,c.getResourceIdAttribute)({config:t,resource:e}),f=(i.data||{}).queryParams;switch(i.type){case e+".INDEX":var m=s.paginated;return a({},r,(0,n.createNewCollection)({metaData:{loading:!0,queryParams:f},models:m?r.models:[]}));case e+".INDEX_SUCCESS":var b=i.response,p=i.metaData,v=i.response[e]||i.response[e.toLowerCase()];if(!Array.isArray(i.response)){if(!v||!Array.isArray(v))return console.error("Response to INDEX actions must be of type array OR contain a top-level key matching the resource name with an array as the value. You can use the parse method(s) set in your config for this resource to transform returned data if needed."),a({},r,(0,n.createNewCollection)({metaData:{loading:!1,loadingError:"Bad data received from server. INDEX calls expect an array."}}));b=v}return s.paginated&&function(){var e=b.reduce(function(e,t){return a({},e,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},t.id,!0))},{});b=[].concat(d(r.models.map(function(e){return e.attributes}).filter(function(t){return!e[t.id]})),d(b))}(),a({},r,(0,n.createNewCollection)({models:b.map(function(e){return(0,n.createNewModel)({id:e[l],attributes:e})}),metaData:p}));case e+".INDEX_ERROR":var y=i.error;return a({},r,(0,n.createNewCollection)({metaData:{loading:!1,loadingError:y}}));case e+".SHOW":var g=(i.data||{}).id;return u?(0,n.createNewModel)({metaData:{loading:!0,queryParams:f},attributes:r.attributes}):a({},r,{models:(0,n.setMemberLoading)({id:g,state:r,queryParams:f})});case e+".SHOW_SUCCESS":var E=i.id,I=i.response,A=i.metaData,M=I;return u?(0,n.createNewModel)({id:E,metaData:A,attributes:a({},r.attributes,M)}):a({},r,(0,n.createNewCollection)({models:(0,n.setMemberAttributes)({id:E,data:M,state:r,metaData:a({loading:!1},A)})}));case e+".SHOW_ERROR":var h=i.id,S=i.error;return u?(0,n.createNewModel)({id:h,attributes:a({},r.attributes),metaData:{loadingError:S}}):a({},r,{models:(0,n.setMemberLoadingError)({state:r,id:h,error:S})});case e+".ASSIGN_CID":var D=i.cId;return u?(0,n.createNewModel)({cId:D}):(0,n.createNewCollection)({models:(0,n.setMemberAttributes)({cId:D,state:r})});case e+".CREATE_SUCCESS":var O=i.cId,_=i.id,T=i.response,C=i.metaData,P=T;return u?(0,n.createNewModel)({id:_,cId:O,attributes:a({},r.attributes,P),metaData:C}):(0,n.createNewCollection)({models:(0,n.setMemberAttributes)({data:P,state:r,id:_,cId:O,metaData:C})});case e+".CREATE_ERROR":var j=i.id,w=i.cId,N=i.error;return u?(0,n.createNewModel)({id:j,cId:w,metaData:{loadingError:N}}):a({},r,{models:(0,n.setMemberLoadingError)({state:r,id:j,cId:w,error:N})});case e+".UPDATE":var U=(i.data||{}).id,R=r.__prevData;return u?(0,n.createNewModel)({id:U,metaData:{loading:!0,__prevData:R},attributes:r.attributes}):a({},r,{models:(0,n.setMemberLoading)({id:U,state:r})});case e+".UPDATE_SUCCESS":var q=i.id,x=i.metaData,L=i.response;return u?(0,n.createNewModel)({id:q,attributes:a({},r.attributes,L),metaData:x}):a({},r,{models:(0,n.setMemberAttributes)({id:q,data:L,metaData:x,state:r,replaceAttributes:!1})});case e+".UPDATE_ERROR":var k=i.id,W=i.error;return u?(0,n.createNewModel)({id:k,attributes:r.attributes,metaData:{loadingError:W}}):a({},r,{models:(0,n.setMemberLoadingError)({state:r,id:k,error:W})});case e+".DESTROY":var G=(i.data||{}).id||r.id;return u?(0,n.createNewModel)({id:G,attributes:r.attributes,metaData:{loading:!0}}):a({},r,{models:(0,n.setMemberLoading)({idAttribute:l,id:G,state:r})});case e+".DESTROY_SUCCESS":var X=i.id;return u?null:a({},r,{models:(0,n.destroyMember)({idAttribute:l,id:X,state:r})});case e+".DESTROY_ERROR":var H=i.id,Y=i.error;return a({},r,u?{loading:!1,loadingError:Y}:{models:(0,n.setMemberLoadingError)({state:r,id:H,idAttribute:l,error:Y})});case e+".SET_LOADING":var B=i.id,F=i.cId;return a({},r,u?{loading:!0,loadingError:void 0}:{models:(0,n.setMemberLoading)({idAttribute:l,id:B,cId:F,state:r})});case e+".SET_OPTIMISTIC_DATA":var Q=function(){var e,t=i.id,o=i.cId,c=i.data,d=u?r:(0,n.findModel)({id:t,cId:o,state:r}),s=a({},d.attributes),l={};return Object.keys(n.apiDefaultState).forEach(function(e){l[e]=d[e]}),e=a({},l,{__prevData:s}),u?{v:(0,n.createNewModel)({id:t,cId:o,attributes:a({},d.attributes,c),metaData:e})}:{v:(0,n.createNewCollection)({models:(0,n.setMemberAttributes)({data:c,state:r,id:t,cId:o,metaData:e})})}}();if("object"===(void 0===Q?"undefined":o(Q)))return Q.v;case e+".UNSET_OPTIMISTIC_DATA":var J=i.id,z=i.cId,K=i.destroy,V=u?r:(0,n.findModel)({id:J,cId:z,state:r});return K&&u?null:K?a({},r,{models:(0,n.destroyTempMemeber)({cId:z,state:r})}):u?(0,n.createNewModel)({id:J,cId:z,attributes:V.__prevData}):(0,n.createNewCollection)({models:(0,n.setMemberAttributes)({data:V.__prevData,state:r,id:J,cId:z})});default:var Z=t.resources[e];return Z&&Z.reducer?Z.reducer(r,i):r}}}),(0,i.combineReducers)(r)}},function(t,r){t.exports=e},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInitialState=t.setMemberLoadingError=t.setMemberLoading=t.destroyTempMemeber=t.destroyMember=t.setMemberAttributes=t.collectionWithUpdatedModel=t.collectionWithNewModel=t.createNewCollection=t.createNewModel=t.findModel=t.apiDefaultState=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},a=r(0);var i=t.apiDefaultState={loading:!1,loadingError:void 0,__prevData:void 0},n=t.findModel=function(e){var t=e.id,r=e.cId,o=e.state,a=o.models&&o.models.slice(0)||[],i=void 0,n=void 0;return a.find(function(e){return i=void 0!==e.id,n=void 0!==r,i&&e.id===t||n&&e.cId===r})},c=t.createNewModel=function(e){var t=e.id,r=e.cId,a=e.metaData,n=e.attributes,c={id:t,cId:r,attributes:o({},void 0===n?{}:n)};return Object.keys(c).forEach(function(e){return void 0===c[e]?delete c[e]:""}),o({},i,a,c)},d=t.createNewCollection=function(e){var t=e.metaData,r=e.models;return o({},i,t,{models:void 0===r?[]:r})},s=t.collectionWithNewModel=function(e){var t=e.state,r=e.model,o=t.models||[];return[].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(o),[r])},u=t.collectionWithUpdatedModel=function(e){var t=e.id,r=e.cId,o=e.state,a=e.updatedModel,i=o.models&&o.models.slice(0)||[],n=void 0,c=void 0;return i.map(function(e){return n=void 0!==e.id,c=void 0!==r,n&&e.id===t||c&&e.cId===r?a:e})},l=t.setMemberAttributes=function(e){var t,r=e.id,a=e.data,i=e.metaData,d=e.state,l=e.cId,f=e.replaceAttributes,m=void 0===f||f,b=(e.replaceMeta,n({id:r,cId:l,state:d}));return b?(t=m?a:o({},b.attributes,a),!l&&b.cId&&(l=b.cId),u({id:r,cId:l,state:d,updatedModel:c({id:r,cId:l,metaData:i,attributes:t})})):s({state:d,model:c({id:r,cId:l,metaData:i,attributes:a})})},f=t.destroyMember=function(e){var t=e.id;return e.state.models.filter(function(e){return e.id!==t})},m=t.destroyTempMemeber=function(e){var t=e.cId;return e.state.models.filter(function(e){return e.cId!==t})},b=t.setMemberLoading=function(e){var t=e.id,r=e.cId,o=e.state,a=e.queryParams,i=n({id:t,cId:r,state:o});return i?u({id:t,cId:r,state:o,updatedModel:c({id:t,cId:r,metaData:{loading:!0,queryParams:a},attributes:i.attributes})}):s({state:o,model:c({id:t,cId:r,metaData:{loading:!0,queryParams:a}})})},p=t.setMemberLoadingError=function(e){var t=e.id,r=e.cId,a=e.state,i=e.error,d=n({id:t,cId:r,state:a});return d||t?d?u({id:t,state:a,cId:r,updatedModel:c(o({},d,{metaData:{loadingError:i,__prevData:d.__prevData}}))}):s({state:a,model:c({id:t,metaData:{loadingError:i}})}):a.models.slice(0)},v=t.getInitialState=function(e){var t=e.config,r=e.resource,o=(0,a.getResourceNameSpace)({config:t,resource:r}),i="attributes"===o,n=t.resources[r]||{},s=(0,a.getResourceIdAttribute)({config:t,resource:r}),u=void 0;return i?(u=n[o]?n[s]||n.attributes[s]:void 0,c({id:u,idAttribute:s,attributes:n.attributes})):d({models:(n.models||[]).map(function(e){return c({idAttribute:s,id:e[s],attributes:e})})})};t.default={apiDefaultState:i,findModel:n,createNewModel:c,createNewCollection:d,collectionWithNewModel:s,collectionWithUpdatedModel:u,setMemberAttributes:l,destroyMember:f,destroyTempMemeber:m,setMemberLoading:b,setMemberLoadingError:p,getInitialState:v}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},a=t.index=function(e){var t=e.resource,r=e.controller;return{type:t+".INDEX",data:{queryParams:e.queryParams},controller:r}},i=t.show=function(e){var t=e.id,r=e.resource,o=e.controller;return{type:r+".SHOW",data:{id:t,queryParams:e.queryParams},controller:o}},n=t.update=function(e){var t=e.id,r=e.attributes,a=e.resource,i=e.controller;return{type:a+".UPDATE",data:o({id:t},r),controller:i}},c=t.create=function(e){return{type:e.resource+".CREATE",data:e.attributes,controller:e.controller}},d=t.destroy=function(e){var t=e.id;return{type:e.resource+".DESTROY",data:{id:t},controller:e.controller}};t.default={index:a,show:i,update:n,create:c,destroy:d}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0);t.default=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var a=(0,o.getConfig)({config:t[0]})||{},i=Object.assign({},a,{resources:Object.assign({},a.resources)});return t.map(function(e){var t=(0,o.getConfig)({config:e});if(t.resources){var r={};return Object.keys(t.resources||{}).forEach(function(e){var i=t.resources[e];"baseUrl"===e&&"string"==typeof i||"optimisticUpdateEnabled"===e&&(0,o.isBool)(i)||(r[e]=Object.assign({},i,{baseUrl:i.baseUrl||t.resources.baseUrl||a.baseUrl,optimisticUpdateEnabled:(0,o.determinOptimisticUpdateSetting)({resourceConfig:i,config:t,defaultConfig:a})}))}),r}}).filter(function(e){return void 0!==e}).forEach(function(e){Object.keys(e).forEach(function(t){var r=e[t];i.resources[t]=Object.assign({},r)})}),i}}])});